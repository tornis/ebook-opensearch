# Custom Parsers for Chapter 5 Exercises

[PARSER]
    Name json
    Format json
    Time_Key timestamp
    Time_Format %Y-%m-%dT%H:%M:%S.%LZ
    Time_Keep on

[PARSER]
    Name apache
    Format regex
    Regex ^\s*(?<remote_ip>[^\s]+)\s+(?<remote_user>[^\s]+)\s+(?<auth_user>[^\s]+)\s+\[(?<timestamp>[^\]]+)\]\s+"(?<method>\w+)\s+(?<path>[^"]+)\s+(?<http_version>[^"]+)"\s+(?<status_code>\d+)\s+(?<bytes_sent>\d+)\s+"(?<referer>[^"]+)"\s+"(?<user_agent>[^"]+)"
    Time_Key timestamp
    Time_Format %d/%b/%Y:%H:%M:%S %z
    Types status_code:integer bytes_sent:integer

[PARSER]
    Name apache_simple
    Format regex
    Regex ^\s*(?<remote_ip>[^\s]+)\s+(?<remote_user>[^\s]+)\s+(?<timestamp>[^\s]+)\s+(?<method>\w+)\s+(?<path>[^\s]+)\s+(?<status_code>\d+)
    Time_Key timestamp
    Types status_code:integer

[PARSER]
    Name multiline
    Format multiline
    parser_firstline regex
    Regex ^(\d{4}-\d{2}-\d{2}\s+\d{2}:\d{2}:\d{2})
